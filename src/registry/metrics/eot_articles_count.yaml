id: eot_articles_count
title: "Article Count"
description: "Total number of articles referencing EOT, from Google Sheets."
type: numeric
unit:
  source: count
  output: count
source:
  primary:
    url: "https://docs.google.com/spreadsheets/d/1uYtLyNrefJRSXAtqwNq9wultzx9ePqyVzQznsQj2tdw/export?format=csv&gid=115580262"
    method: GET
    format: html
    # Google Docs requires auth or returns a login page for direct CSV export SOMETIMES.
    # If the sheet is strictly public, it should work.
    # The output above shows HTML (login page), implying we need an API key or public access.
    # WAIT: User said it's public? 
    # If the sheet is "Anyone with link can view", the export URL often works.
    # However, curl was redirected or blocked.
    # Let's try the `pubhtml` or `tq` API.
    # The `tq` (Query) API is often better for public sheets: 
    # https://docs.google.com/spreadsheets/d/1uYtLyNrefJRSXAtqwNq9wultzx9ePqyVzQznsQj2tdw/gviz/tq?tqx=out:csv&gid=115580262
  fallback:
    value: 916
    as_of: "2025-02-05"
normalization:
  language: "javascript"
  function: "if (typeof data === 'string' && data.includes('EOT')) { return (data.match(/EOT/g) || []).length + (data.match(/Possible EOT Links/g) || []).length; } return 0;" 
  # This is a placeholder. A CSV needs line counting.
  # If we get a CSV, we can count rows?
  # column A lists "EOT" or "Possible EOT Links"
display:
  section: "Impact"
  order: 1
